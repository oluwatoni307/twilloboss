<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Voice Call Assistant Tester</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        h1 {
            text-align: center;
            color: #333;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            font-weight: bold;
            margin-bottom: 5px;
        }
        input[type="text"], input[type="tel"], input[type="datetime-local"], textarea, select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }
        textarea {
            height: 150px;
            resize: vertical;
        }
        button {
            background-color: #4CAF50;
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background-color: #45a049;
        }
        .toggle-group {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }
        .toggle-label {
            margin-right: 10px;
            font-weight: bold;
        }
        .toggle-btn {
            display: flex;
        }
        .toggle-btn button {
            border-radius: 0;
            padding: 8px 15px;
            background-color: #e0e0e0;
            color: #333;
        }
        .toggle-btn button.active {
            background-color: #4CAF50;
            color: white;
        }
        .toggle-btn button:first-child {
            border-radius: 4px 0 0 4px;
        }
        .toggle-btn button:last-child {
            border-radius: 0 4px 4px 0;
        }
        #response {
            margin-top: 20px;
            padding: 15px;
            background-color: #f8f8f8;
            border-radius: 4px;
            border-left: 4px solid #4CAF50;
            display: none;
        }
        #loader {
            display: none;
            text-align: center;
            margin-top: 20px;
        }
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 2s linear infinite;
            margin: 0 auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .tabs {
            display: flex;
            margin-bottom: 20px;
        }
        .tab {
            padding: 10px 20px;
            background-color: #e0e0e0;
            cursor: pointer;
            margin-right: 5px;
            border-radius: 5px 5px 0 0;
        }
        .tab.active {
            background-color: #4CAF50;
            color: white;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Voice Call Assistant Tester</h1>
        
        <div class="tabs">
            <div class="tab active" data-tab="schedule">Schedule Call</div>
            <div class="tab" data-tab="settings">Settings</div>
        </div>
        
        <div id="schedule" class="tab-content active">
            <div class="toggle-group">
                <span class="toggle-label">Call Type:</span>
                <div class="toggle-btn">
                    <button id="immediate" class="active" onclick="toggleCallType('immediate')">Immediate</button>
                    <button id="scheduled" onclick="toggleCallType('scheduled')">Scheduled</button>
                </div>
            </div>
            
            <div class="form-group">
                <label for="phone">Phone Number:</label>
                <input type="tel" id="phone" placeholder="+1234567890" required>
            </div>
            
            <div class="form-group" id="scheduleTimeGroup" style="display: none;">
                <label for="scheduleTime">Schedule Time:</label>
                <input type="datetime-local" id="scheduleTime">
            </div>
            
            <div class="form-group">
                <label for="language">Language:</label>
                <select id="language">
                    <option value="English">English</option>
                    <option value="Spanish">Spanish</option>
                    <option value="French">French</option>
                    <option value="German">German</option>
                    <option value="Mandarin">Mandarin</option>
                    <option value="Japanese">Japanese</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="accent">Accent:</label>
                <select id="accent">
                    <option value="American">American</option>
                    <option value="British">British</option>
                    <option value="Australian">Australian</option>
                    <option value="Indian">Indian</option>
                    <option value="Natural">Natural</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="prompt">AI Assistant Prompt:</label>
                <textarea id="prompt" placeholder="Instructions for the AI assistant...">You are a friendly voice assistant that helps answer questions. Be concise and helpful.</textarea>
            </div>
            
            <button onclick="scheduleCall()">Submit Call Request</button>
        </div>
        
        <div id="settings" class="tab-content">
            <div class="form-group">
                <label for="apiUrl">API URL:</label>
                <input type="text" id="apiUrl" value="http://localhost:5050/schedule-call">
            </div>
            <button onclick="saveSettings()">Save Settings</button>
        </div>
        
        <div id="loader">
            <div class="spinner"></div>
            <p>Processing request...</p>
        </div>
        
        <div id="response"></div>
    </div>

    <script>
        // Default settings
        let apiUrl = 'https://b2ca-102-89-84-113.ngrok-free.app/schedule-call';
        let callType = 'immediate';
        
        // Load saved settings if available
        document.addEventListener('DOMContentLoaded', function() {
          
            // Set default time to 5 minutes from now
            const now = new Date();
            now.setMinutes(now.getMinutes() + 5);
            document.getElementById('scheduleTime').value = now.toISOString().slice(0, 16);
        });
        
        // Toggle between immediate and scheduled call
        function toggleCallType(type) {
            callType = type;
            document.getElementById('immediate').classList.remove('active');
            document.getElementById('scheduled').classList.remove('active');
            document.getElementById(type).classList.add('active');
            
            if(type === 'scheduled') {
                document.getElementById('scheduleTimeGroup').style.display = 'block';
            } else {
                document.getElementById('scheduleTimeGroup').style.display = 'none';
            }
        }
        
        // Tab switching
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', function() {
                // Remove active class from all tabs
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                // Add active class to clicked tab
                this.classList.add('active');
                
                // Hide all tab contents
                document.querySelectorAll('.tab-content').forEach(content => {
                    content.classList.remove('active');
                });
                
                // Show the corresponding tab content
                const tabId = this.getAttribute('data-tab');
                document.getElementById(tabId).classList.add('active');
            });
        });
        
        // Save settings
        function saveSettings() {
            apiUrl = document.getElementById('apiUrl').value.trim();
            localStorage.setItem('apiUrl', apiUrl);
            
            showResponse({
                status: 'success',
                message: 'Settings saved successfully!'
            });
        }
        
        // Schedule call function
        function scheduleCall() {
            const phone = document.getElementById('phone').value.trim();
            const language = document.getElementById('language').value;
            const accent = document.getElementById('accent').value;
            const prompt = document.getElementById('prompt').value.trim();
            
            if(!phone) {
                showResponse({
                    status: 'error',
                    message: 'Phone number is required!'
                });
                return;
            }
            
            let callTime = new Date();
            if(callType === 'scheduled') {
                const scheduledTime = document.getElementById('scheduleTime').value;
                if(!scheduledTime) {
                    showResponse({
                        status: 'error',
                        message: 'Schedule time is required for scheduled calls!'
                    });
                    return;
                }
                callTime = new Date(scheduledTime);
            }
            
            const payload = {
                to_phone_number: phone,
                call_type: callType === 'immediate',
                call_time: callTime.toISOString(),
                Language: language,
                Accent: accent,
                prompt: prompt
            };
            
            // Show loader
            document.getElementById('loader').style.display = 'block';
            document.getElementById('response').style.display = 'none';
            
            // Send request
            fetch(apiUrl, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(payload)
            })
            .then(response => response.json())
            .then(data => {
                document.getElementById('loader').style.display = 'none';
                showResponse({
                    status: 'success',
                    message: data.message || 'Call scheduled successfully!',
                    data: data
                });
            })
            .catch(error => {
                document.getElementById('loader').style.display = 'none';
                showResponse({
                    status: 'error',
                    message: 'Error: ' + error.message
                });
            });
        }
        
        // Show response message
        function showResponse(response) {
            const responseElement = document.getElementById('response');
            responseElement.style.display = 'block';
            
            if(response.status === 'error') {
                responseElement.style.borderLeftColor = '#ff5252';
            } else {
                responseElement.style.borderLeftColor = '#4CAF50';
            }
            
            let html = `<strong>${response.status === 'error' ? 'Error' : 'Success'}:</strong> ${response.message}`;
            
            if(response.data) {
                html += '<pre>' + JSON.stringify(response.data, null, 2) + '</pre>';
            }
            
            responseElement.innerHTML = html;
        }
    </script>
</body>
</html>